# GeliÅŸmiÅŸ karakter analizini web ortamÄ±nda Ã§alÄ±ÅŸtÄ±rmak iÃ§in Flask kullanacaÄŸÄ±z.
# Bu Ã¶rnekte, kullanÄ±cÄ± web arayÃ¼zÃ¼nden sorulara cevap verecek, ardÄ±ndan kiÅŸilik analizi ve karakter taklidi sunulacak.

from flask import Flask, render_template_string, request
from textblob import TextBlob
from collections import defaultdict

app = Flask(__name__)

# HTML arayÃ¼z ÅŸablonu
html_template = """
<!DOCTYPE html>
<html>
<head>
    <title>Karakter Analizi</title>
    <style>
        body { font-family: Arial; padding: 30px; background-color: #f4f4f4; }
        h1 { color: #444; }
        textarea { width: 100%; height: 80px; }
        .question { margin-bottom: 20px; }
        .result { background-color: #fff; padding: 20px; margin-top: 30px; border-radius: 5px; }
        input[type="submit"] { padding: 10px 20px; font-size: 16px; }
    </style>
</head>
<body>
    <h1>Karakter Analizi Formu</h1>
    <form method="post">
        {% for cat, qs in questions.items() %}
            <h3>{{ cat.upper() }}</h3>
            {% for q in qs %}
                <div class="question">
                    <label>{{ q }}</label><br>
                    <textarea name="{{ q }}"></textarea>
                </div>
            {% endfor %}
        {% endfor %}
        <input type="submit" value="Analizi Tamamla">
    </form>

    {% if summary %}
    <div class="result">
        <h2>ğŸ” Karakter Ã–zeti</h2>
        <ul>
            {% for trait, score in summary.items() %}
                <li><strong>{{ trait.capitalize() }}:</strong> {{ "%.2f"|format(score) }}%</li>
            {% endfor %}
        </ul>
        <h3>ğŸ§  Taklit Cevap:</h3>
        <p><strong>Soru:</strong> {{ user_question }}</p>
        <p><strong>Karakterin CevabÄ±:</strong> {{ simulated_answer }}</p>
    </div>
    {% endif %}
</body>
</html>
"""

# GeliÅŸmiÅŸ karakter profili sÄ±nÄ±fÄ±
class AdvancedCharacterProfile:
    def __init__(self):
        self.responses = defaultdict(list)
        self.trait_scores = defaultdict(float)

    def analyze_response(self, category, question, response):
        self.responses[category].append((question, response))

        blob = TextBlob(response)
        polarity = blob.sentiment.polarity
        subjectivity = blob.sentiment.subjectivity

        if polarity > 0.2:
            self.trait_scores["pozitiflik"] += polarity
        elif polarity < -0.2:
            self.trait_scores["negatiflik"] += abs(polarity)
        else:
            self.trait_scores["tarafsÄ±zlÄ±k"] += 1

        if subjectivity > 0.5:
            self.trait_scores["duygusallÄ±k"] += subjectivity
        else:
            self.trait_scores["rasyonellik"] += (1 - subjectivity)

        self.trait_scores["dilsel_karmaÅŸÄ±klÄ±k"] += len(response.split()) / 10

    def summarize(self):
        total = sum(self.trait_scores.values()) or 1  # sÄ±fÄ±ra bÃ¶lme hatasÄ±nÄ± Ã¶nlemek iÃ§in
        return {trait: (score / total) * 100 for trait, score in self.trait_scores.items()}

    def simulate_answer(self, user_question):
        blob = TextBlob(user_question)
        style = []

        if self.trait_scores["pozitiflik"] > self.trait_scores["negatiflik"]:
            base_response = "Bana gÃ¶re bu konuyu iyimser bir bakÄ±ÅŸ aÃ§Ä±sÄ±yla deÄŸerlendirmek gerek."
        elif self.trait_scores["negatiflik"] > self.trait_scores["pozitiflik"]:
            base_response = "Bu konuda oldukÃ§a temkinliyim ve pek iyimser dÃ¼ÅŸÃ¼nemem."
        else:
            base_response = "Bu meseleye oldukÃ§a tarafsÄ±z yaklaÅŸÄ±rÄ±m."

        if self.trait_scores["duygusallÄ±k"] > self.trait_scores["rasyonellik"]:
            style.append("Ä°Ã§imde hissettiklerim her zaman aÄŸÄ±r basar.")
        else:
            style.append("Daha Ã§ok mantÄ±ÄŸÄ±mÄ± kullanÄ±rÄ±m bÃ¶yle durumlarda.")

        if self.trait_scores["dilsel_karmaÅŸÄ±klÄ±k"] > 5:
            style.append("Bu konuyu detaylandÄ±rmak gerekirse, Ã§ok katmanlÄ± dÃ¼ÅŸÃ¼nÃ¼yorum.")
        else:
            style.append("AslÄ±nda oldukÃ§a sade dÃ¼ÅŸÃ¼nÃ¼yorum bu konuda.")

        return base_response + " " + " ".join(style)

# Sorular kategorilere gÃ¶re
questions_advanced = {
    'duygusal': [
        "Seni en son ne aÄŸlattÄ±?",
        "Bir hayal kÄ±rÄ±klÄ±ÄŸÄ±nÄ± nasÄ±l atlatÄ±rsÄ±n?",
        "BaÅŸkalarÄ± seni yanlÄ±ÅŸ anladÄ±ÄŸÄ±nda ne hissedersin?"
    ],
    'ahlaki': [
        "Yalan sÃ¶ylemek hangi durumda kabul edilebilir?",
        "Kendin iÃ§in doÄŸru ama baÅŸkasÄ± iÃ§in zararlÄ± bir ÅŸey yapar mÄ±sÄ±n?",
        "Birinin suÃ§u Ã¼stlenmeni istese ne yaparsÄ±n?"
    ],
    'dÃ¼ÅŸÃ¼nsel': [
        "Ä°nsan doÄŸasÄ± hakkÄ±nda ne dÃ¼ÅŸÃ¼nÃ¼yorsun?",
        "GerÃ§eÄŸe ulaÅŸmanÄ±n en iyi yolu sence nedir?",
        "Her bilginin sorgulanabilir olmasÄ± gerektiÄŸine inanÄ±r mÄ±sÄ±n?"
    ],
    'sosyal': [
        "Toplumun birey Ã¼zerindeki etkisi sence ne kadar gÃ¼Ã§lÃ¼?",
        "YalnÄ±z kalmayÄ± mÄ± kalabalÄ±ÄŸÄ± mÄ± tercih edersin?",
        "Sosyal medyanÄ±n insan iliÅŸkilerine etkisi hakkÄ±nda ne dÃ¼ÅŸÃ¼nÃ¼yorsun?"
    ],
    'gÃ¼ndelik': [
        "Bir gÃ¼nÃ¼nÃ¼ nasÄ±l planlarsÄ±n?",
        "Stresli bir gÃ¼nÃ¼n ardÄ±ndan nasÄ±l rahatlÄ±yorsun?",
        "DÃ¼zenli biri misin yoksa daÄŸÄ±nÄ±klÄ±k seni rahatsÄ±z etmez mi?"
    ],
    'dil': [
        "Ä°roni yapmayÄ± sever misin? Hangi durumlarda?",
        "Kelimelerin insanlar Ã¼zerindeki etkisine inanÄ±r mÄ±sÄ±n?",
        "Kendini ifade ederken hangi tarz sana daha yakÄ±n?"
    ]
}

@app.route('/', methods=['GET', 'POST'])
def form():
    summary = None
    simulated_answer = None
    user_question = "Hayatta baÅŸarÄ±yÄ± neye borÃ§luyuz sence?"

    if request.method == 'POST':
        profile = AdvancedCharacterProfile()
        for cat, qs in questions_advanced.items():
            for q in qs:
                answer = request.form.get(q, "")
                if answer.strip():
                    profile.analyze_response(cat, q, answer)

        summary = profile.summarize()
        simulated_answer = profile.simulate_answer(user_question)

    return render_template_string(
        html_template,
        questions=questions_advanced,
        summary=summary,
        simulated_answer=simulated_answer,
        user_question=user_question
    )

# Flask sunucusunu Ã§alÄ±ÅŸtÄ±r
if __name__ == '__main__':
    app.run(debug=True)
